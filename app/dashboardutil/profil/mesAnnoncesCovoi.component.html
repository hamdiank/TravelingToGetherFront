<!-- CSS Files Dashboard Utilisateur -->
<link href="/assets/css/material-kit.css" rel="stylesheet"/>

<!-- CSS Files AnnonceCovoi template -->
<link rel="stylesheet" type="text/css" href="/assets/css/style.css" rel="stylesheet"/>

<!-- ************************************************************************** -->
<div class="profile-page">
    <div class="wrapper">
		<div class="header header-filter" style="background-image: url('./assets/img/faces/city3.jpg');"></div>
            <div class="main main-raised">
                <div class="profile-content">
                    <div class="container">
                        <div class="body1">
<!-- ******************************** Row ****************************************** -->                        
 <button type="button" class=" btn btn-danger btn-lg btn-round " style="position:fixed; margin-left:1000px;  " [routerLink]="['/dashboardutil/AjoutAnnonceCovoi']"  >
        <i class="material-icons">add</i>
</button>  
<!-- ************************************************************************** -->


<!-- ***************************Row*********************************************** -->
    <div style="width:800px;">
     <alert></alert>
    </div>
	<div class="row" *ngFor="let annonceCovoi of annoncesCovoi | paginate: {itemsPerPage: 5, currentPage:page, id: '1'}; let i = index" >
        <div class="col-md-4 col-sm-6">
            <div class="card-container1 manual-flip">
                <div class="card1">
                    <div class="front">
                        <div class="cover">
                            <img src="https://www.clipartsgram.com/image/124089475-california-beaches-tumblr-wallpaper-3.jpg"/>
                        </div>
                        <div class="user">
                            <img class="img-circle" src="https://www2.mmu.ac.uk/media/mmuacuk/style-assets/images/r-research/profile-Zeyad.jpg"/>
                        </div>
                        <div class="content">
                            <div class="main">
								<div class="row" >
								  <div class="col-sm-3 block1">
										<h3 class="name">{{annonceCovoi.utilisateur.login}}</h3>
										<p class="profession">{{annonceCovoi.utilisateur.profession}} </p>
										<p class="age">{{annonceCovoi.utilisateur.age}}</p>
										<p class="score">
											<span class="glyphicon glyphicon-star-empty icon">
											</span>
											<span class="glyphicon glyphicon-star-empty">
											</span>
										</p>
								  </div>
								  <div class="col-sm-6 block2">
										<h3 class="date"> {{annonceCovoi.dateDepart}}<span class="block21">  <span class="glyphicon glyphicon-time"></span>&nbsp;&nbsp;&nbsp;{{annonceCovoi.heureDepart}} </span> </h3>
										<p class="adresse">
											<span class="adresseDepart">{{annonceCovoi.paysDepart}},{{annonceCovoi.villeDepart}}</span>
											<span class="glyphicon glyphicon-arrow-right" ></span>
											<span class="adresseArrivee">{{annonceCovoi.paysArrivee}},{{annonceCovoi.villeArrivee}}</span>
											<span class="glyphicon glyphicon-road"></span> 
										</p>
                                        <button style="width:130px;" type="button"  data-toggle="modal" data-target="#myModal3" (click)="onClick(annonceCovoi)">En attente <span class="glyphicon glyphicon-user"></span> <span class="glyphicon glyphicon-plus-sign"></span> </button>
                                        <br>
                                        <br>
                                        
                                         <button type="button"  style="width:130px;" data-toggle="modal" data-target="#myModal4" (click)="onClick(annonceCovoi)">Acceptés<span class="glyphicon glyphicon-user"></span> <span  class="glyphicon glyphicon-ok-circle"></span> </button>
                                  </div>
								  <div class="col-sm-3 block3" >
										<p class="cotisation" > {{annonceCovoi.cotisation}},<span class="cotisation1" >00</span>
										<span class="glyphicon glyphicon-euro"></span> </p>
										<p class="cotisation2"> par Place </p>
										<p class="places" *ngIf="annonceCovoi.nombrePlaces==0">
											Complet
											<a href="#" style="color: red">
											<span class="glyphicon glyphicon-ok"></span>
											</a>
										</p>
										<div *ngIf="annonceCovoi.nombrePlaces!=0">
										<p class="places" >{{annonceCovoi.nombrePlaces}}
											<a href="#" style="color: dodgerblue">
											<span class="glyphicon glyphicon-user places1"></span>
											</a>
										</p>
										
										<p class="places2 "> Places restantes </p>
										</div>
								  </div>
								</div>
                            </div>
                            <div class="footer">
								<button class="btn btn-simple" style=" width:50px;" (click)="getCommentairesByAnnonce(annonceCovoi.id)"  >
                                    <i class="material-icons" style="color:#1ab394;">comment</i> &nbsp;&nbsp;<a style="color: gray" >Commentaires </a>
                                </button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <button style="margin-left: 50px;" class="btn btn-simple" >
                                    <i class="fa fa-mail-forward" style="color:#1ab394 "></i> &nbsp;&nbsp;<a style="color:gray " [routerLink]="['/dashboardutil/detail', annonceCovoi.id]">Les détails </a>
                                </button>
                                <span style="margin-left: 180px;">
                                    <button type="button" rel="tooltip" title="Edit Annonce" class="btn btn-success btn-simple btn-xs" data-toggle="modal" data-target="#myModal1" (click)="onClick(annonceCovoi)">
                                        <i class="fa fa-edit"></i>
                                    </button>
                                </span>
                                <span>
                                    <button type="button" rel="tooltip" title="Supprimer Annonce" class="btn btn-danger btn-simple btn-xs" data-toggle="modal" data-target="#myModal2" (click)="onClick(annonceCovoi)">
                                            <i class="fa fa-times"></i>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div> <!-- end front panel -->
                </div> <!-- end card -->
            </div> <!-- end card-container -->
			<div class="container" style="width: 1100px; " *ngIf="idAnnonceCovoi==annonceCovoi.id">
    <div class="col-sm-8">
        <div class="panel panel-white post panel-shadow">
            <div class="post-footer">
				 <form #myForm="ngForm" (ngSubmit)="addCommentaire()">
                <div class="input-group"> 
					<input class="form-control" placeholder="Ajouter commentaire" type="text"  [(ngModel)]="model.text" name="text"   #text="ngModel"  required>
                    <span class="input-group-addon">
                        <a > <i class="material-icons" style="color:#1ab394;">comment</i><button type="submit" style="height: 40px;"> Commenter</button> </a>  
                    </span>
					
                </div>
				 </form>
                <ul class="comments-list" *ngFor="let commentaire of commentaires">
					
                    <li class="comment">
                        <a class="pull-left" href="#">
                           <img class="avatar" src="https://www2.mmu.ac.uk/media/mmuacuk/style-assets/images/r-research/profile-Zeyad.jpg"/>
                        </a>
                        <div class="comment-body">
                            <div class="comment-heading">
                                <h4 class="user">{{commentaire.author.prenom}}</h4>
                                <h5 class="time">{{commentaire.date}}</h5>
                            </div>
							<div class="row">
								<div class="col-md-6">
									<p style="display: inline-block;">{{commentaire.text}}</p>
								</div>
								<div class="col-md-6" *ngIf="id==annonceCovoi.utilisateur.idUtilisateur || commentaire.author.idUtilisateur==id">
									<button style="display: inline-block; margin-left: 200px;" type="button" rel="tooltip" title="Supprimer Commentaire" class="btn btn-danger btn-simple btn-xs" data-toggle="modal" data-target="#myModal" (click)="onClickCommentaire(commentaire)">
										<i class="fa fa-times"></i>
									</button>
								</div>
							</div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
        </div> <!-- end col sm 3 -->
	</div>
           <!-- Affichage du Modal-->
                            <!-- Modal -->
                            <div class="modal fade" id="myModal1" role="dialog">
                                <div class="modal-dialog modal-lg">
                                
                                <!-- Modal content-->
                                <div class="modal-content">
                                      
                                    <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h4 class="modal-title">Modifier Annonce de Covoiturage</h4>
                                    </div>
                                    
                                    <div class="modal-body">  
                    <form name="form" (ngSubmit)="modifierAnnonceCovoi()" #f="ngForm" >
                        <div class="row">
                            <div class="col-md-6">   
                                <div class="form-group form-black label-floating is-empty">
                                    <label> <span class="glyphicon glyphicon-calendar"></span> &nbsp; &nbsp;  Date Départ</label> <br>
                                    <input type="date" [(ngModel)]="model.dateDepart" value="Date Depart"name="dateDepart"  #dateDepart="ngModel" required>
                                </div>                        
                            </div>
                            <div class="col-md-6">
                                <div class="form-group form-black label-floating is-empty">
                                    <label> <span class="glyphicon glyphicon-time"></span> &nbsp; &nbsp; Heure Départ</label>
                                    <br>
                                    <input type="time"  [(ngModel)]="model.heureDepart" name="heureDepart"   #heureDepart="ngModel"  style="width: 150px; height: 30px;" required>
                                    
                                </div>
                            </div>
                        </div>
                        <hr>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group form-black label-floating is-empty">
                                    <label><i class="material-icons" style="font-size:20px;">place</i>Pays Départ</label>
                                    <br>
                                    <select class="selectpicker" [(ngModel)]="model.paysDepart"  (change)="onSelect1($event.target.value)"  name="paysDepart" required  #paysDepart="ngModel" style="width: 200px; height: 30px;" (click)="changePaysDepart()">
                                        <option value="0">--Select--</option>  
                                            <option value= {{model.paysDepart}} *ngIf="testPaysDepart===false">{{model.paysDepart}}</option>
                                            <option *ngFor="let pay of pays" value= {{pay.idPays}}>{{pay.nom}}</option>
                                   </select> 
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group form-black label-floating is-empty">
                                    <label> <i class="material-icons" style="font-size:20px;">place</i>Ville Départ</label>
                                    <br>
                                    <select [(ngModel)]="model.villeDepart"  name="villeDepart"   #villeDepart="ngModel" style="width: 200px; height: 30px;" required>
                                        <option value="0">Select Ville Depart</option>
                                         <option value= {{model.villeDepart}} *ngIf="testVilleDepart===false">{{model.villeDepart}}</option>
                                        <option *ngFor="let city of cities " value= {{city.nom}}>{{city.nom}}</option>
                                    </select> 
                                </div>
                            </div>
                        </div>
                         <hr>
                         
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group form-black label-floating is-empty">
                                    <label> <i class="material-icons" style="font-size:20px;">place</i>Pays Arrivée</label>
                                    <br>
                                    <select class="selectpicker" [(ngModel)]="model.paysArrivee"  (change)="onSelect2($event.target.value)"  name="paysDepart" required  #paysDepart="ngModel" style="width: 200px; height: 30px;" (click)="changePaysArrivee()">
                                        <option value="0">--Select--</option>  
                                            <option value= {{model.paysArrivee}} *ngIf="testPaysArrivee===false">{{model.paysArrivee}}</option>
                                            <option *ngFor="let pay of pays" value= {{pay.idPays}}>{{pay.nom}}</option>
                                   </select> 
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group form-black label-floating is-empty">
                                    <label> <i class="material-icons" style="font-size:20px;">place</i>Ville Arrivée</label>
                                    <br>
                                    <select [(ngModel)]="model.villeArrivee"  name="villeArrivee"   #villeArrivee="ngModel" style="width: 200px; height: 30px;" required>
                                        <option  value="0">--Select--</option>
                                        <option value= {{model.villeArrivee}} *ngIf="testVilleArrivee===false">{{model.villeArrivee}}</option>
                                        <option *ngFor="let city of cities2 " value= {{city.nom}}>{{city.nom}}</option>
                                    </select> 
                                </div>
                            </div>
                        </div>
                         <hr>

                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group form-black label-floating is-empty">
                                    <h6>Nombre de Places </h6>
                                    <p-spinner size="10"  [min]="0" [max]="100"  [(ngModel)]="model.nombrePlaces"  name="nombrePlaces"   #nombrePlaces="ngModel" required ></p-spinner>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group form-black label-floating is-empty">
                                    <h6 > Cotisation </h6>
                                    <p-spinner size="10"  [min]="1" [max]="1000"  [(ngModel)]="model.cotisation"  name="cotisation"   #cotisation="ngModel" required ></p-spinner>
                
                                </div>
                            </div>
                        </div>
  
    
                        <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                        <button  type="submit" class="btn btn-success" >Modifier</button>
                        </div>
                    </form>
                                    </div>
                                    
                                    <div class="modal-footer">
                                
                                    </div>
                                </div>
                                </div>
                            </div>   
    <!-- fin   modal -->
    <div id="myModal2" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Suppression</h4>
      </div>
      <div class="modal-body">
        <p>Voulez-vous vraiment supprimer cette Annonce ?</p>
      </div>
      <div class="modal-footer">
        <button (click)="supprimerAnnonceCovoi()" type="button" class="btn btn-success" data-dismiss="modal" >Oui</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal">Annuler</button>
      </div>
    </div>

  </div>
</div>
   <!-- Affichage Modal3 -->
<div id="myModal3" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Les Réservations en attente</h4>
      </div>
      <div class="modal-body">
<div class="container">
	<div class="row" *ngFor="let reservation of reservations ; let i= index" >
        <div class="col-sm-6" *ngIf="reservation.etat== false">
            <div class="business-card">
                <div class="media">
                    <div class="media-left">
                        <img class="media-object img-circle profile-img" src="http://s3.amazonaws.com/37assets/svn/765-default-avatar.png">
                    </div>
                    <div class="media-body">
                        <div class="col-sm-4">
                            <h2 class="media-heading">{{reservation.utilisateurReservation.nom}}</h2>
                            <div class="job">{{reservation.utilisateurReservation.profession}}</div>
                        <div class="mail"><a href="mailto:daniel@bla.ch">voir profil</a> </div>
                        </div>
                        <div class="col-sm-8">
                            <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="refuserReservation()" (click)="onClickReservation(reservation)" [disabled]="reservation.etat==true">Refuser</button>
                        </div>  
                        <div class="col-sm-8">
                         <button type="button" class="btn btn-success" data-dismiss="modal"  (click)="onClickReservation(reservation)" (click)="accepterReservation()" [disabled]="reservation.etat==true" >Accepter</button>
                           </div>  
                    </div>
                </div>
            </div>
        </div>


	</div>
</div>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>
<!-- fin Modal -->


   <!-- Affichage Modal4 -->
<div id="myModal4" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Liste des Acceptés</h4>
      </div>
      <div class="modal-body">
<div class="container">
	<div class="row" *ngFor="let reservation of reservations; let i = index" >
        <div class="col-sm-6" *ngIf="reservation.etat==true" >
            <div class="business-card">
                <div class="media">
                    <div class="media-left">
                        <img class="media-object img-circle profile-img" src="http://s3.amazonaws.com/37assets/svn/765-default-avatar.png">
                    </div>
                    <div class="media-body" >
                        <div class="col-sm-4">
                            <h2 class="media-heading">{{reservation.utilisateurReservation.nom}}</h2>
                            <div class="job">{{reservation.utilisateurReservation.profession}}</div>
                        <div class="mail"><a href="#">voir profil</a> </div>
                        </div>
                        <div class="col-sm-4" style="margin-top:80px ;margin-left: 120px; padding-left: 40px;" > <p><span style="color: red" *ngIf="reservation.confirmation==false">Non confirmé</span><br><span style="color: green"  *ngIf="reservation.confirmation==true">Confirmé</span> </p> </div>
  
                    </div>
                </div>
            </div>
        </div>
	</div>

</div>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>
<!-- fin Modal -->
	    <div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Suppression Commentaire</h4>
      </div>
      <div class="modal-body">
        <p>Voulez-vous vraiment supprimer ce comentaire ?</p>
      </div>
      <div class="modal-footer">
        <button (click)="supprimerCommentaire()" type="button" class="btn btn-success" data-dismiss="modal" >Oui</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal">Annuler</button>
      </div>
    </div>

  </div>
</div>
<pagination-controls class=" pull-right" (pageChange)="page = $event" id="1" maxSize="3" directionLinks="true" autoHide="true">
</pagination-controls>

<!-- ************************************************************************** -->
        </div>
<!-- ************************************************************************** -->

        </div>
    </div>
</div>
</div>
</div>